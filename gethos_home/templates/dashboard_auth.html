{% load static %}

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Central</title>
    <link rel="stylesheet" href="{% static 'gethos_home/css/dashboard_auth.css' %}">

</head>


<body>
    {% comment %} INSERÇÃO DO MENU HEADER {% endcomment %}
    
    {% include 'menu_header.html' %}
    
    {% comment %} FIM DA INSERÇÃO DO MENU HEADER {% endcomment %}
      
      <div class="cards-container">
        <div class="card">
          <div class="card-content">
            <p class="card-title">Teste</p>
            <h3 class="card-amount">R$</h3>
            <p class="card-change positive">+10%</p>
            <span class="timeframe">7 Dias</span>
          </div>
        </div>
      
        <div class="card">
          <div class="card-content">
            <p class="card-title">Teste</p>
            <h3 class="card-amount">Teste</h3>
            <p class="card-change negative">-15%</p>
            <span class="timeframe">Cadastrado em 30/06/2024
            </span>
          </div>
        </div>
      
        <div class="card">
          <div class="card-content">
            <p class="card-title">Teste</p>
            <h3 class="card-amount">Teste</h3>
            <p class="card-change positive">+25%</p>
            <span class="timeframe">Teste</span>
          </div>
        </div>
      
        <div class="card">
          <div class="card-content">
            <p class="card-title">Teste</p>
            <h3 class="card-amount">$teste</h3>
            <p class="card-change positive">+30%</p>
            <span class="timeframe">teste 12 meses</span>
          </div>
        </div>
      </div>
      {% comment %} Início tabela de contatos {% endcomment %}
      <div class="table-container">
        <!-- <div class="container-div-p">
        </div> -->
        <div class="container-div">
          <p class="list-contacts-title"><strong>LISTA DE CONTATOS</strong></p>
          <button class="adc-contato">Criar Novo Contato</button>
        </div>

        <!-- Button to open the modal -->


<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
<div class="modal-content">
  <span class="close">&times;</span>
  <h2>Adicionar Novo Contato</h2>
  
  <!-- Formulário configurado corretamente -->
  <form method="POST" action="{% url 'dashboard_auth' %}">
      {% csrf_token %}  <!-- Adiciona proteção CSRF necessária no Django -->
      
      <label for="name">Nome</label>
      <input type="text" id="name" name="nome" placeholder="E.g. Olivia" required>
      
      <label for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="E.g. olivia@gmail.com" required>
      
      <label for="phone">Telefone</label>
      <input type="tel" id="phone" name="telefone" placeholder="E.g. 5582991326715" required>

      <label for="empresa">Empresa</label>
      <input type="emp" id="empresa" name="empresa" placeholder="Empresa">
      
      <label for="status">Status</label>
      <select id="status" name="status" required>
          <option value="Ativo">Ativo</option>
          <option value="Inativo">Inativo</option>
      </select>
      
      <button type="submit" class="create-btn">Criar</button>
  </form>
</div>


</div>

<div class="page-wrapper">
  <div class="main-content">
      <!-- Tabela de Contatos -->
      <form method="POST" action="{% url 'dashboard_auth' %}">
          {% csrf_token %}
          <table class="contacts-table">
              <thead>
                  <tr>
                      <th><input type="checkbox" id="select-all"></th> <!-- Checkbox para selecionar todos -->
                      <th>ID</th>
                      <th>Nome</th>
                      <th>Telefone</th>
                      <th>E-mail</th>
                      <th>Empresa</th>
                      <th>Score</th>
                      <th>Status</th>
                      <th>Ação</th>
                  </tr>
              </thead>
              <tbody>
                  {% for contato in listContacts %}
                  <tr>
                      <td><input type="checkbox" name="selected_contacts" value="{{ contato.id }}" class="contact-checkbox"></td> <!-- Checkbox individual -->
                      <td>{{ contato.id }}</td>
                      <td>{{ contato.nome }}</td>
                      <td>{{ contato.telefone }}</td>
                      <td>{{ contato.email }}</td>
                      <td>{{ contato.empresa }}</td>
                      <td>{{ contato.status }}</td>
                      <td>{{ contato.score }}</td>
                      <td>
                          <button href="#" class="action-btn view-btn">Ver</button>
                          <button href="#" class="action-btn edit-btn">Editar</button>
                          <button href="#" class="action-btn delete-btn">Excluir</button>
                      </td>
                  </tr>
                  {% endfor %}
              </tbody>
          </table>
          <button type="submit" class="submit-btn">Realizar Ação</button> <!-- Botão para enviar contatos selecionados -->
      </form>
      
      <!-- Sidebar retrátil -->
      <div id="sidebox" class="sidebox">
        <h3>Ações para Contatos Selecionados</h3>
        <p id="selected-count">Nenhum contato selecionado</p> <!-- Exibe a quantidade de contatos selecionados -->
        <button class="sidebox-btn">Excluir</button>
        <button class="sidebox-btn">Enviar E-mail</button>
        <button class="sidebox-btn">Exportar Contatos</button>
      </div>
  </div>
    
</div>
      
      
</body>
<script>

var modal = document.getElementById("myModal");

// Seleciona o botão que abre o modal
var btn = document.querySelector(".adc-contato");

// Seleciona o <span> que fecha o modal
var span = document.getElementsByClassName("close")[0];

// Quando o botão é clicado, abre o modal
btn.onclick = function() {
  modal.style.display = "block";
}

// Quando o <span> é clicado, fecha o modal
span.onclick = function() {
  modal.style.display = "none";
}

// Quando o usuário clica fora do modal, ele fecha
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}


{% comment %} script para realizar ação com os contatos selecionados. {% endcomment %}
// Script para selecionar ou desmarcar todos os checkboxes
document.getElementById('select-all').addEventListener('click', function(event) {
  let checkboxes = document.querySelectorAll('input[name="selected_contacts"]');
  checkboxes.forEach(checkbox => checkbox.checked = event.target.checked);
  toggleSidebox(); // Chama a função para verificar se a sidebar deve aparecer
});

// Script para monitorar a seleção dos checkboxes individuais
const contactCheckboxes = document.querySelectorAll('.contact-checkbox');
contactCheckboxes.forEach(checkbox => {
  checkbox.addEventListener('change', toggleSidebox);
});

// Função que exibe ou esconde a sidebar com base na seleção de checkboxes
function toggleSidebox() {
  let selectedCount = Array.from(contactCheckboxes).filter(checkbox => checkbox.checked).length;
  let sidebox = document.getElementById('sidebox');
  let selectedCountElement = document.getElementById('selected-count');
  
  if (selectedCount > 0) {
      sidebox.classList.add('sidebox-active');

      // Atualiza o texto da quantidade de contatos selecionados
      if (selectedCount === 1) {
          selectedCountElement.textContent = "1 contato selecionado";
      } else if (selectedCount === contactCheckboxes.length) {
          selectedCountElement.textContent = "Todos os contatos selecionados";
      } else {
          selectedCountElement.textContent = `${selectedCount} contatos selecionados`;
      }
  } else {
      sidebox.classList.remove('sidebox-active');
      selectedCountElement.textContent = "Nenhum contato selecionado";
  }
}

</script>
</html>

